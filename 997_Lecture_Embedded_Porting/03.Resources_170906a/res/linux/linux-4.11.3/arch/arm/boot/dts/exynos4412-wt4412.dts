/*
 * Device tree source file for Willtek WT4412 board based on Exynos4412
 *
 * This program is free software; you can redistribute it and/or modify
 * it under the terms of the GNU General Public License version 2 as
 * published by the Free Software Foundation.
*/

/dts-v1/;
#include <dt-bindings/sound/samsung-i2s.h>
#include <dt-bindings/input/input.h>
#include "exynos4412.dtsi"
#include "exynos4412-ppmu-common.dtsi"
#include <dt-bindings/gpio/gpio.h>
#include "exynos-mfc-reserved-memory.dtsi"

/ {
	model = "Willtek WT4412 board based on Exynos4412";
	compatible = "willtek,wt4412", "samsung,exynos4412", "samsung,exynos4";

	memory@40000000 {
		device_type = "memory";
		reg = <0x40000000 0x7FF00000>;
	};

	chosen {
		stdout-path = &serial_1;
	};

	firmware@0204F000 {
		compatible = "samsung,secure-firmware";
		reg = <0x0204F000 0x1000>;
	};

	gpio_keys {
		compatible = "gpio-keys";
		pinctrl-names = "default";
		pinctrl-0 = <&gpio_power_key>;

		power_key {
			interrupt-parent = <&gpx0>;
			interrupts = <4 0>;
			gpios = <&gpx0 4 GPIO_ACTIVE_LOW>;
			linux,code = <KEY_POWER>;
			label = "power key";
			debounce-interval = <10>;
			wakeup-source;
		};
	};

	sound: sound {
		compatible = "simple-audio-card";

		simple-audio-card,format = "i2s";
		simple-audio-card,bitclock-master = <&link0_cpu>;
		simple-audio-card,frame-master = <&link0_cpu>;

		link0_cpu: simple-audio-card,cpu {
			sound-dai = <&i2s0 0>;
			//system-clock-frequency = <19200000>;
		};

		link0_codec: simple-audio-card,codec {
			sound-dai = <&wm8960>;
			clocks = <&i2s0 CLK_I2S_CDCLK>;
		};
	};

	emmc_pwrseq: pwrseq {
		pinctrl-0 = <&sd1_cd>;
		pinctrl-names = "default";
		compatible = "mmc-pwrseq-emmc";
		reset-gpios = <&gpk1 2 GPIO_ACTIVE_LOW>;
	};

	camera {
		status = "okay";
		pinctrl-names = "default";
		pinctrl-0 = <>;
	};

	fixed-rate-clocks {
		xxti {
			compatible = "samsung,clock-xxti";
			clock-frequency = <0>;
		};

		xusbxti {
			compatible = "samsung,clock-xusbxti";
			clock-frequency = <24000000>;
		};

		codec_mclk: codec-mclk {
			compatible = "fixed-clock";
			#clock-cells = <0>;
			clock-frequency = <16934000>;
		};

		/* James Kim 170831: add for rtc clock */
		xrtcxti: xrtcxti {
			compatible = "fixed-clock";
			clock-frequency = <32768>;
			clock-output-names = "xrtcxti";
			#clock-cells = <0>;
	 	};
	};

	leds {
		compatible = "gpio-leds";
		led1 {
			label = "led1:heart";
			gpios = <&gpc1 0 GPIO_ACTIVE_LOW>;
			default-state = "on";
			linux,default-trigger = "heartbeat";
		};

		/* James Kim 170607: add for backlight test */
		led2 {
			label = "led2:bl";
			gpios = <&gpx0 7 GPIO_ACTIVE_HIGH>;
			default-state = "on";
			linux,default-trigger = "bl";
		};

		/* James Kim 170608: add for BL control */
		led3 {
			label = "led3:blpwm";
			gpios = <&gpd0 0 GPIO_ACTIVE_HIGH>;
			default-state = "on";
			linux,default-trigger = "blpwm";
		};
	};
};

&bus_dmc {
	devfreq-events = <&ppmu_dmc0_3>, <&ppmu_dmc1_3>;
	//vdd-supply = <&buck1_reg>;
	status = "okay";
};

&bus_acp {
	devfreq = <&bus_dmc>;
	status = "okay";
};

&bus_c2c {
	devfreq = <&bus_dmc>;
	status = "okay";
};

&bus_leftbus {
	devfreq-events = <&ppmu_leftbus_3>, <&ppmu_rightbus_3>;
	//vdd-supply = <&buck3_reg>;
	status = "okay";
};

&bus_rightbus {
	devfreq = <&bus_leftbus>;
	status = "okay";
};

&bus_display {
	devfreq = <&bus_leftbus>;
	status = "okay";
};

&bus_fsys {
	devfreq = <&bus_leftbus>;
	status = "okay";
};

&bus_peri {
	devfreq = <&bus_leftbus>;
	status = "okay";
};

&bus_mfc {
	devfreq = <&bus_leftbus>;
	status = "okay";
};

&clock_audss {
	assigned-clocks = <&clock_audss EXYNOS_MOUT_AUDSS>,
			<&clock_audss EXYNOS_MOUT_I2S>,
			<&clock_audss EXYNOS_DOUT_SRP>,
			<&clock_audss EXYNOS_DOUT_AUD_BUS>;
	assigned-clock-parents = <&clock CLK_FOUT_EPLL>,
			<&clock_audss EXYNOS_MOUT_AUDSS>;
	assigned-clock-rates = <0>, <0>, <192000000>, <19200000>;
	//assigned-clock-rates = <0>, <0>, <192000000>, <11200000>;
};

&cpu0 {
	//cpu0-supply = <&buck2_reg>;
};

/* RSTN signal for eMMC */
&sd1_cd {
	samsung,pin-pud = <EXYNOS_PIN_PULL_NONE>;
	samsung,pin-drv = <EXYNOS4_PIN_DRV_LV1>;
};

&pinctrl_1 {
	gpio_power_key: power_key {
		samsung,pins = "gpx0-4";
		samsung,pin-pud = <EXYNOS_PIN_PULL_NONE>;
	};
};

&ehci {
	status = "okay";
};

&exynos_usbphy {
	status = "okay";
};

&fimc_0 {
	status = "okay";
	assigned-clocks = <&clock CLK_MOUT_FIMC0>,
			<&clock CLK_SCLK_FIMC0>;
	assigned-clock-parents = <&clock CLK_MOUT_MPLL_USER_T>;
	assigned-clock-rates = <0>, <176000000>;
};

&fimc_1 {
	status = "okay";
	assigned-clocks = <&clock CLK_MOUT_FIMC1>,
			<&clock CLK_SCLK_FIMC1>;
	assigned-clock-parents = <&clock CLK_MOUT_MPLL_USER_T>;
	assigned-clock-rates = <0>, <176000000>;
};

&fimc_2 {
	status = "okay";
	assigned-clocks = <&clock CLK_MOUT_FIMC2>,
			<&clock CLK_SCLK_FIMC2>;
	assigned-clock-parents = <&clock CLK_MOUT_MPLL_USER_T>;
	assigned-clock-rates = <0>, <176000000>;
};

&fimc_3 {
	status = "okay";
	assigned-clocks = <&clock CLK_MOUT_FIMC3>,
			<&clock CLK_SCLK_FIMC3>;
	assigned-clock-parents = <&clock CLK_MOUT_MPLL_USER_T>;
	assigned-clock-rates = <0>, <176000000>;
};

&hsotg {
	dr_mode = "peripheral";
	status = "okay";
	//vusb_d-supply = <&ldo15_reg>;
	//vusb_a-supply = <&ldo12_reg>;
};

&i2c_0 {
	samsung,i2c-sda-delay = <100>;
	samsung,i2c-max-bus-freq = <400000>;
	status = "okay";

	usb3503: usb3503@08 {
		compatible = "smsc,usb3503";
		reg = <0x08>;

		intn-gpios = <&gpx3 0 GPIO_ACTIVE_HIGH>;
		connect-gpios = <&gpx3 4 GPIO_ACTIVE_HIGH>;
		reset-gpios = <&gpx3 5 GPIO_ACTIVE_HIGH>;
		initial-mode = <1>;
	};

	pixcir_ts@5c {
                pinctrl-names = "default";
                compatible = "pixcir,pixcir_tangoc";
                reg = <0x5c>;
                interrupt-parent = <&gpx1>;
                interrupts = <0 IRQ_TYPE_EDGE_FALLING>;
                attb-gpio = <&gpx1 0 GPIO_ACTIVE_HIGH>;
                reset-gpio = <&gpx1 1 GPIO_ACTIVE_LOW>;
                touchscreen-size-x = <1024>;
                touchscreen-size-y = <600>;
	};
};

&i2c_1 {
	status = "okay";

	samsung,i2c-sda-delay = <100>;
	samsung,i2c-max-bus-freq = <20000>;

	wm8960: wm8960@1a {
		compatible = "wlf,wm8960";
		reg = <0x1a>;
		clocks = <&i2s0 CLK_I2S_CDCLK>;
		clock-names = "mclk";
		#sound-dai-cells = <0>;
        };
};

&i2c_2 {
	status = "okay";
};

&i2c_8 {
	status = "okay";
};

&i2s0 {
	pinctrl-0 = <&i2s0_bus>;
	pinctrl-names = "default";
	status = "okay";
};

&mixer {
	status = "okay";
};

&mshc_0 {
	pinctrl-0 = <&sd4_clk &sd4_cmd &sd4_bus4 &sd4_bus8>;
	pinctrl-names = "default";
	//vmmc-supply = <&ldo20_reg>;
	mmc-pwrseq = <&emmc_pwrseq>;
	status = "okay";

	num-slots = <1>;
	broken-cd;
	card-detect-delay = <200>;
	samsung,dw-mshc-ciu-div = <3>;
	samsung,dw-mshc-sdr-timing = <2 3>;
	samsung,dw-mshc-ddr-timing = <1 2>;
	bus-width = <8>;
	cap-mmc-highspeed;
};

&rtc {
	status = "okay";
	clocks = <&clock CLK_RTC>, <&xrtcxti 0>;
	clock-names = "rtc", "rtc_src";
};

&sdhci_2 {
	bus-width = <4>;
	pinctrl-0 = <&sd2_clk &sd2_cmd &sd2_cd &sd2_bus4>;
	pinctrl-names = "default";
	//vmmc-supply = <&ldo21_reg>;
	//vqmmc-supply = <&ldo4_reg>;
	cd-gpios = <&gpk2 2 GPIO_ACTIVE_HIGH>;
	cd-inverted;
	status = "okay";
};

&serial_0 {
	status = "okay";
};

&serial_1 {
	status = "okay";
};

&watchdog {
	status = "okay";
};

&usb3503 {
	clock-names = "refclk";
	clocks = <&pmu_system_controller 0>;
	/* James Kim 170729: change 24MHz to 26MHz */
	//refclk-frequency = <24000000>;
	refclk-frequency = <26000000>;
};

&ehci {
	port@1 {
		status = "okay";
	};
	port@2 {
		status = "okay";
	};
};

&sound {
	simple-audio-card,name = "WT4412-WM8960";
	//simple-audio-card,widgets =
		//"Headphone", "Headphone Jack",
		//"Speakers", "Speakers";

		//"Microphone", "Microphone Jack",
		//"Headphone", "Headphone Jack",
		//"Speaker", "External Speaker";

		//"Headphone", "Headphone Jack";
	//simple-audio-card,routing =
		//"Headphone Jack", "HPL",
		//"Headphone Jack", "HPR",
		//"Headphone Jack", "MICBIAS",
		//"IN1", "Headphone Jack",
		//"Speakers", "SPKL",
		//"Speakers", "SPKR";

		//"MIC_IN", "Microphone Jack",
		//"Headphone Jack", "HP_OUT",
		//"External Speaker", "LINE_OUT";

		//"Headphone Jack", "HP_L",
		//"Headphone Jack", "HP_R";
};

&spi_1 {
	pinctrl-names = "default";
	pinctrl-0 = <&spi1_bus>;
	cs-gpios = <&gpb 5 GPIO_ACTIVE_HIGH>;
	status = "okay";
};

&pinctrl_0 {
srom_ctl: srom-ctl {
		  samsung,pins = "gpy0-3", "gpy0-4", "gpy0-5",
			  "gpy1-0", "gpy1-1", "gpy1-2", "gpy1-3";
		  samsung,pin-function = <EXYNOS_PIN_FUNC_2>;
		  samsung,pin-drv = <EXYNOS4_PIN_DRV_LV1>;
	  };

srom_ebi: srom-ebi {
		  samsung,pins = "gpy3-0", "gpy3-1", "gpy3-2", "gpy3-3",
			  "gpy3-4", "gpy3-5", "gpy3-6", "gpy3-7",
			  "gpy5-0", "gpy5-1", "gpy5-2", "gpy5-3",
			  "gpy5-4", "gpy5-5", "gpy5-6", "gpy5-7",
			  "gpy6-0", "gpy6-1", "gpy6-2", "gpy6-3",
			  "gpy6-4", "gpy6-5", "gpy6-6", "gpy6-7";
		  samsung,pin-function = <EXYNOS_PIN_FUNC_2>;
		  samsung,pin-pud = <EXYNOS_PIN_PULL_UP>;
		  samsung,pin-drv = <EXYNOS4_PIN_DRV_LV1>;
	  };
};

&sromc {
	pinctrl-names = "default";

	ethernet@1,0 {
		compatible = "smsc,lan9115";
		reg = <1 0 0x10000>;
		phy-mode = "mii";
		interrupt-parent = <&gpx1>;
		interrupts = <3 IRQ_TYPE_EDGE_FALLING>;
		reg-io-width = <2>;
		smsc,irq-push-pull;
		smsc,force-internal-phy;

		samsung,srom-page-mode;
		samsung,srom-timing = <9 12 1 9 1 1>;
		//samsung,srom-timing = <9 12 1 6 1 1>;
	};
};

&fimd {
	pinctrl-0 = <&lcd_clk &lcd_data24 &pwm0_out>;
	pinctrl-names = "default";
	status = "okay";

	display-timings {
		native-mode = <&timing0>;
		timing0: timing {
			clock-frequency = <47500000>;
			hactive = <1024>;
			vactive = <600>;
			hfront-porch = <64>;
			hback-porch = <16>;
			hsync-len = <48>;
			vback-porch = <64>;
			vfront-porch = <16>;
			vsync-len = <3>;
		};
	};
};

